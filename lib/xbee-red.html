<script type="text/javascript">
  RED.nodes.registerType('xbee-tx', {
    category: 'iot',
    color: '#3FADB5',
    defaults: {
      name: { value: '' },
      xBee: { value: '', type: "xbee-config" }
    },
    inputs: 1,
    outputs: 0,
    icon: "xbee.png",
    align: 'right',
    label: function () {
      return this.name || "XBee TX";
    },
    paletteLabel: "XBee TX"
  });

  RED.nodes.registerType('xbee-rx', {
    category: 'iot',
    color: '#3FADB5',
    defaults: {
      name: { value: '' },
      xBee: { value: '', type: "xbee-config" }
    },
    inputs: 0,
    outputs: 1,
    icon: "xbee.png",
    label: function () {
      return this.name || "XBee RX";
    },
    paletteLabel: "XBee RX"
  });

  RED.nodes.registerType('xbee-config', {
    category: 'config',
    defaults: {
      serialPort: { value: '', required: true },
      baudRate: { value: 9600, required: true },
      apiMode: { value: '1', required: true }
    },
    label: function () {
      return 'XBee[api:'+this.apiMode+']@' + this.serialPort + ":" + this.baudRate;
    },
    oneditprepare: function(){
      var node = this;
      var baudRates = [
        9600,19200,38400,57600,115200,230400,460800,921600
      ];
      var apiModes = [
        {name:'API 1', value: '1' },
        {name:'API 2 (escaped characters)', value: '2' }
      ];
      for (i=0; i<baudRates.length;i++){
        $('#node-config-input-baudRate').append(
          '<option value='+baudRates[i]+
            ((node.baudRate == baudRates[i]) ? ' selected>' : '>') +
            baudRates[i] +
            '</option>');
      }
      for (i=0; i<apiModes.length;i++){
        $('#node-config-input-apiMode')
          .append(
            '<option value=' +
            apiModes[i].value +
            ((node.apiMode == apiModes[i].value) ? ' selected>' : '>') +
            apiModes[i].name +
            '</option>');
      }
    }
  });

</script>

<script type="text/x-red" data-template-name="xbee-tx">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
    <input type="text" id="node-input-name" placeholder="Name">
  </div>
  <div class="form-row">
    <label for="node-input-xBee"><i class="fa fa-cog"></i> XBee</label>
    <input type="text" id="node-input-xBee" placeholder="Serial Port">
  </div>
</script>

<script type="text/x-red" data-help-name="xbee-tx">
  <p>XBee Node is intended to Transmit Data </p>
</script>

<script type="text/x-red" data-template-name="xbee-rx">
  <div class="form-row">
    <label for="node-input-name"><i class="fa fa-tag"></i> Name TX</label>
    <input type="text" id="node-input-name" placeholder="Name">
  </div>
  <div class="form-row">
    <label for="node-input-xBee"><i class="fa fa-cog"></i> XBee</label>
    <input type="text" id="node-input-xBee" placeholder="Serial Port">
  </div>
</script>

<script type="text/x-red" data-help-name="xbee-rx">
  <p>XBee Node is intended to Continuously Receive Data </p>
</script>

<script type="text/x-red" data-template-name="xbee-config">
    <div class="form-row">
        <label for="node-config-input-serialPort"><i class="fa fa-usb"></i> Serial Port</label>
        <input type="text" id="node-config-input-serialPort">
    </div>
    <div class="form-row">
        <label for="node-config-input-baudRate"><i class="fa fa-filter"></i> Baud Rate</label>
        <select id="node-config-input-baudRate">
      </select>
    </div>
    <div class="form-row">
    <label for="node-config-input-apiMode"><i class="fa fa-code"></i> API Mode</label>
    <select id="node-config-input-apiMode"></select>
  </div>
</script>
